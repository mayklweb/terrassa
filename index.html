<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="./style/main.css" />
    <title>Terrassa Khiva | Terrassa Restaurant & Cafe</title>
  </head>
  <body>
    <div class="wrapper">
      <header class="header">
        <div class="container">
          <div class="header-row">
            <div class="header-logo"></div>
            <div class="header-action"></div>
          </div>
        </div>
      </header>
      <main class="main">
        <div id="progress"></div>
      </main>
      <footer class="footer"></footer>
    </div>
    <script src="./js/three/three.min.js"></script>
    <script src="./js/penolens/penolens.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/panolens@0.12.0/build/panolens.min.js"></script>
    <script>
      let panorama,
        panorama2,
        viewer,
        progress,
        progressElement,
        panorama3,
        panorama4,
        panorama5,
        panorama6,
        panorama7,
        panorama8;

      progressElement = document.getElementById("progress");

      function onEnter(event) {
        progressElement.style.width = 0;
        progressElement.classList.remove("finish");
      }

      function onProgress(event) {
        progress = (event.progress.loaded / event.progress.total) * 100;
        progressElement.style.width = progress + "%";
        if (progress === 100) {
          progressElement.classList.add("finish");
        }
      }

      // First panorama
      panorama = new PANOLENS.ImagePanorama("media/1.webp");

      panorama.addEventListener("progress", onProgress);
      panorama.addEventListener("enter", onEnter);

      // Second panorama
      panorama2 = new PANOLENS.ImagePanorama("media/2.webp");
      panorama2.addEventListener("progress", onProgress);
      panorama2.addEventListener("enter", onEnter);

      panorama3 = new PANOLENS.ImagePanorama("media/3.webp");
      panorama3.addEventListener("progress", onProgress);
      panorama3.addEventListener("enter", onEnter);

      panorama4 = new PANOLENS.ImagePanorama("media/4.webp");
      panorama4.addEventListener("progress", onProgress);
      panorama4.addEventListener("enter", onEnter);

      panorama5 = new PANOLENS.ImagePanorama("media/5.webp");
      panorama5.addEventListener("progress", onProgress);
      panorama5.addEventListener("enter", onEnter);

      panorama6 = new PANOLENS.ImagePanorama("media/6.webp");
      panorama6.addEventListener("progress", onProgress);
      panorama6.addEventListener("enter", onEnter);

      panorama7 = new PANOLENS.ImagePanorama("media/7.webp");
      panorama7.addEventListener("progress", onProgress);
      panorama7.addEventListener("enter", onEnter);

      panorama8 = new PANOLENS.ImagePanorama("media/8.webp");
      panorama8.addEventListener("progress", onProgress);
      panorama8.addEventListener("enter", onEnter);

      // Linking panoramas
      panorama.link(panorama2, new THREE.Vector3(4000, 160, 360));

      panorama2.link(panorama3, new THREE.Vector3(-300, 800, -3800));

      panorama3.link(panorama4, new THREE.Vector3(-2500, 400, 1400));

      panorama4.link(panorama5, new THREE.Vector3(-2000, -200, 1100));
      panorama4.link(panorama6, new THREE.Vector3(550, -200, 1800));
      panorama4.link(panorama3, new THREE.Vector3(0, -1400, -2200));
      panorama4.link(panorama7, new THREE.Vector3(-800, 550, -2400));

      panorama5.link(panorama6, new THREE.Vector3(1100, 0, -2600));

      panorama6.link(panorama7, new THREE.Vector3(2400, 100, -800));
      panorama6.link(panorama5, new THREE.Vector3(-2600, 0, 600));

      panorama7.link(panorama6, new THREE.Vector3(-1400, 0, 100));

      viewer = new PANOLENS.Viewer();
      viewer.add(
        panorama,
        panorama2,
        panorama3,
        panorama4,
        panorama5,
        panorama6,
        panorama7,
        panorama8
      );
    </script>
  </body>
</html>
